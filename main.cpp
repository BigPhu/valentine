// COMPILE CODE: g++ -std=c++17 main.cpp -o main
// RUN CODE: ./main

#include <windows.h>
#include "geometry.hpp"
#include "renderer.hpp"
#include "lirik.hpp"
#include "terminal.hpp"

Vec3<float> heartVertices[50] = {
    Vec3<float>(-0.006481, -1.94645, -0.013239),
    Vec3<float>(-1.87755, 1.24066, -0),
    Vec3<float>(-0.32054, -1.7176, -0.012546),
    Vec3<float>(1.38981, 1.00252, 0.447632),
    Vec3<float>(1.83088, 0.225251, -0),
    Vec3<float>(1.0487, -0.127617, 0.45896),
    Vec3<float>(0.91471, 0.442098, 0.579154),
    Vec3<float>(1.57512, -0.343224, -0.003037),
    Vec3<float>(1.09229, -0.977298, -0.006406),
    Vec3<float>(0.356229, -1.6895, -0.011449),
    Vec3<float>(0.005924, -1.46644, 0.463266),
    Vec3<float>(-1.09964, -0.992756, -0.009954),
    Vec3<float>(0.442435, -0.465647, 0.596013),
    Vec3<float>(0.003694, -0.862795, 0.642248),
    Vec3<float>(-0.429903, -0.47089, 0.606401),
    Vec3<float>(-0.886088, 0.426588, 0.604291),
    Vec3<float>(-1.02844, -0.128875, 0.492092),
    Vec3<float>(-1.59367, -0.3359, -0.007483),
    Vec3<float>(-1.85384, 0.241912, -0.00498),
    Vec3<float>(-0.841515, 0.881729, 0.611155),
    Vec3<float>(-1.36559, 1.00267, 0.482851),
    Vec3<float>(0.003171, 1.14495, 0.455759),
    Vec3<float>(-0.784587, 1.36823, 0.513724),
    Vec3<float>(0.825468, 1.38114, 0.49601),
    Vec3<float>(0.859999, 0.889647, 0.593023),
    Vec3<float>(-0.002051, 1.51834, -0.003425),
    Vec3<float>(0.824851, 1.94046, -0.007248),
    Vec3<float>(1.46989, 1.74966, -0.007212),
    Vec3<float>(1.85965, 1.24098, -0.005236),
    Vec3<float>(-0.845386, 1.94764, -0.00492),
    Vec3<float>(-1.47833, 1.76254, -0.003106),
    Vec3<float>(-0.352289, 1.79004, -0.002825),
    Vec3<float>(0.338837, 1.78843, -0.003744),
    Vec3<float>(-1.87185, 0.294213, 0.004746),
    Vec3<float>(1.38981, 1.00252, -0.447632),
    Vec3<float>(1.0487, -0.127618, -0.45896),
    Vec3<float>(0.91471, 0.442098, -0.579154),
    Vec3<float>(0.005924, -1.46644, -0.463266),
    Vec3<float>(-0.350338, -1.6939, 0.012471),
    Vec3<float>(0.442435, -0.465647, -0.596013),
    Vec3<float>(0.003694, -0.862796, -0.642248),
    Vec3<float>(-0.429903, -0.47089, -0.606401),
    Vec3<float>(-0.886088, 0.426588, -0.604291),
    Vec3<float>(-1.02844, -0.128875, -0.492092),
    Vec3<float>(-0.841515, 0.881728, -0.611155),
    Vec3<float>(-1.36559, 1.00267, -0.482851),
    Vec3<float>(0.003171, 1.14495, -0.455759),
    Vec3<float>(-0.784587, 1.36823, -0.513724),
    Vec3<float>(0.825468, 1.38114, -0.49601),
    Vec3<float>(0.859999, 0.889647, -0.593023)
};

int heartTriangles[285] = {
    27, 3, 28,
    3, 4, 28,
    6, 4, 3,
    5, 7, 4,
    5, 8, 7,
    8, 10, 9,
    10, 0, 9,
    10, 2, 0,
    10, 11, 2,
    12, 8, 5,
    12, 13, 10,
    13, 14, 10,
    14, 11, 10,
    16, 14, 15,
    16, 17, 11,
    16, 18, 17,
    15, 19, 20,
    18, 15, 20,
    20, 33, 18,
    1, 20, 30,
    19, 21, 22,
    29, 22, 31,
    22, 29, 30,
    20, 22, 30,
    23, 3, 27,
    24, 6, 3,
    6, 12, 5,
    12, 21, 14,
    26, 23, 27,
    32, 23, 26,
    23, 21, 24,
    23, 32, 25,
    27, 28, 34,
    34, 28, 4,
    4, 36, 34,
    35, 4, 7,
    35, 7, 8,
    8, 9, 37,
    37, 9, 0,
    37, 2, 38,
    37, 38, 11,
    8, 39, 35,
    39, 37, 40,
    40, 37, 41,
    41, 11, 43,
    43, 42, 41,
    43, 11, 17,
    43, 17, 18,
    42, 45, 44,
    42, 18, 45,
    45, 33, 1,
    1, 30, 45,
    44, 47, 46,
    29, 31, 47,
    47, 30, 29,
    47, 45, 30,
    34, 48, 27,
    49, 34, 36,
    36, 35, 39,
    42, 44, 46,
    26, 27, 48,
    32, 26, 48,
    48, 49, 46,
    47, 31, 25,
    6, 5, 4,
    12, 10, 8,
    14, 16, 11,
    18, 16, 15,
    20, 1, 33,
    20, 19, 22,
    23, 24, 3,
    6, 24, 21,
    21, 19, 15,
    15, 14, 21,
    14, 13, 12,
    12, 6, 21,
    25, 31, 22,
    22, 21, 25,
    21, 23, 25,
    4, 35, 36,
    37, 0, 2,
    8, 37, 39,
    41, 37, 11,
    42, 43, 18,
    45, 18, 33,
    47, 44, 45,
    34, 49, 48,
    46, 49, 36,
    36, 39, 46,
    39, 40, 41,
    46, 39, 41,
    41, 42, 46,
    25, 32, 48,
    48, 46, 25,
    46, 47, 25
};

int main() {
    setColor(5, 0);
    printLirik();

    hideCursor();
    std::cout << "\033[1;33m           --- Sending my love to you ---\n";
    loadingBar(53, 1600);
    
    clearScreen();
    setColor(12, 0);
    
    Renderer test(80, 29, 50, 20, ' ', ".,-~:;=!*#$@", 20, 0.04);
    test.vertex(50, heartVertices);
    test.triangle(285, heartTriangles);
    test.light(5.0f, Vec3<float>(0.0f, 0.0f, -1.0f), 10);
    test.rotation(0.0f, 0.03f, 0.0f);

    float i = 0;
    int frame = 0;
    while (true) {
        if (GetAsyncKeyState(VK_ESCAPE)) {
            std::cout << "Escape key pressed. Exitting...\n";
            break;
        } 
        
        test.translation(Vec3<float>(0.0f, sin(i)/2, 0.0f));
        test.resetBuffers();
        test.render();
        
        i += 0.04;
        ++frame;
    }

    return 0;
}